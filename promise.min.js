/*
 * [promise.coffee](http://github.com/CodeCatalyst/promise.coffee) v1.0.1
 * Copyright (c) 2012-2013 [CodeCatalyst, LLC](http://www.codecatalyst.com/).
 * Open source under the [MIT License](http://en.wikipedia.org/wiki/MIT_License).
 */
(function(){var d,s,h,f,t,e;t=("undefined"!==typeof process&&null!==process?process.nextTick:void 0)||setImmediate||function(a){return setTimeout(a,0)};f=function(a){return"function"===typeof a};var u=function(a,c){var l,d,e,m,n,p,j,q,k,r,h;this.promise=new s(this);j=[];m=k=!1;n=p=null;f(c)||(c=function(b){throw b;});r=function(){var b,g,a;g=0;for(a=j.length;g<a;g++)b=j[g],b[n](p);j=[]};h=function(b){j.push(b);m&&r()};l=function(b,g){a=c=null;n=b;p=g;m=!0;r()};e=function(b){l("resolve",b)};d=function(b){l("reject",
b)};q=function(b,a){k=!0;try{f(b)&&(a=b(a)),a&&f(a.then)?a.then(e,d):e(a)}catch(c){d(c)}};this.resolve=function(b){k||q(a,b)};this.reject=function(a){k||q(c,a)};this.then=function(a,c){var d;return f(a)||f(c)?(d=new u(a,c),t(function(){return h(d)}),d.promise):this.promise}};h=u;s=function(a){this.then=function(c,d){return a.then(c,d)}};d=function(){var a;a=new h;this.promise=a.promise;this.resolve=function(c){return a.resolve(c)};this.reject=function(c){return a.reject(c)}};e="undefined"!==typeof exports&&
null!==exports?exports:window;e.Deferred=d;e.defer=function(){return new d}}).call(this);
