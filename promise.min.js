/*
 * [promise.coffee](http://github.com/CodeCatalyst/promise.coffee) v1.0.3
 * Copyright (c) 2012-2013 [CodeCatalyst, LLC](http://www.codecatalyst.com/).
 * Open source under the [MIT License](http://en.wikipedia.org/wiki/MIT_License).
 */
(function(){var d,w,x,y,l,g,z,A,h;A=null!=("undefined"!==typeof process&&null!==process?process.nextTick:void 0)?process.nextTick:"undefined"!==typeof setImmediate&&null!==setImmediate?setImmediate:function(a){return setTimeout(a,0)};y=new (function(){return function(){var a,b;b=[];a=function(){var a;for(a=0;a<b.length;)b[a++]();b.length=0};this.schedule=function(c){1===b.push(c)&&A(a)}}}());l=function(a){return y.schedule(a)};g=function(a){return"function"===typeof a};z=function(a){return a===Object(a)};
x=function(){function a(b,c){var d,m,h,k,s,t,f,u,n,p,v,q;p=new w(this);f=[];k=n=!1;s=t=null;g(c)||(c=function(e){throw e;});v=function(){var e,a,b;a=0;for(b=f.length;a<b;a++)e=f[a],e[s](t);f.length=0};d=function(a,B){b=c=null;s=a;t=B;k=!0;0<f.length&&l(v)};h=function(a){k||d("resolve",a)};m=function(a){k||d("reject",a)};q=function(e){var b,r,c;try{if(e===p)throw new TypeError("A Promise cannot be resolved with itself.");if((z(e)||g(e))&&g(c=e.then))try{r=new a(q,m),c.call(e,r.resolve,r.reject)}catch(d){b=
d,r.reject(b)}else h(e)}catch(f){b=f,m(b)}};u=function(a,b){n=!0;null!=b?l(function(){try{g(b)&&(a=b(a)),q(a)}catch(c){m(c)}}):q(a)};this.resolve=function(a){n||u(a,b)};this.reject=function(a){n||u(a,c)};this.then=function(b,c){var d;return g(b)||g(c)?(d=new a(b,c),f.push(d),k&&l(v),d.promise):p};this.promise=p}return a}();w=function(){return function(a){this.then=function(b,c){return a.then(b,c)}}}();d=function(){return function(){var a;a=new x;this.promise=a.promise;this.resolve=function(b){return a.resolve(b)};
this.reject=function(b){return a.reject(b)}}}();h="undefined"!==typeof exports&&null!==exports?exports:window;h.Deferred=d;h.defer=function(){return new d}}).call(this);
