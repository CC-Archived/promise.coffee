/*
 * [promise.coffee](http://github.com/CodeCatalyst/promise.coffee) v1.0.2
 * Copyright (c) 2012-2013 [CodeCatalyst, LLC](http://www.codecatalyst.com/).
 * Open source under the [MIT License](http://en.wikipedia.org/wiki/MIT_License).
 */
(function(){var d,x,y,f,z,m,g;m=null!=("undefined"!==typeof process&&null!==process?process.nextTick:void 0)?process.nextTick:"undefined"!==typeof setImmediate&&null!==setImmediate?setImmediate:function(b){return setTimeout(b,0)};f=function(b){return"function"===typeof b};z=function(b){return b===Object(b)};y=function(){function b(c,h){var d,n,g,l,t,u,k,v,p,q,w,r;q=new x(this);k=[];l=p=!1;t=u=null;f(h)||(h=function(a){throw a;});w=function(){var a,e,b;e=0;for(b=k.length;e<b;e++)a=k[e],a[t](u);k=[]};
d=function(a,b){c=h=null;t=a;u=b;l=!0;0<k.length&&m(function(){return w()})};g=function(a){l||d("resolve",a)};n=function(a){l||d("reject",a)};r=function(a){var e,s,c;try{if(a===q)throw new TypeError("A Promise cannot be resolved with itself.");if(z(a)||f(a))if(c=a.then,f(c))try{s=new b(r,n),c.call(a,s.resolve,s.reject)}catch(d){e=d,s.reject(e)}else g(a);else g(a)}catch(h){e=h,n(e)}};v=function(a,b){p=!0;null!=b?m(function(){try{f(b)&&(a=b(a)),r(a)}catch(c){n(c)}}):r(a)};this.resolve=function(a){p||
v(a,c)};this.reject=function(a){p||v(a,h)};this.then=function(a,c){var d;return f(a)||f(c)?(d=new b(a,c),k.push(d),l&&m(function(){return w()}),d.promise):q};this.promise=q}return b}();x=function(){return function(b){this.then=function(c,d){return b.then(c,d)}}}();d=function(){return function(){var b;b=new y;this.promise=b.promise;this.resolve=function(c){return b.resolve(c)};this.reject=function(c){return b.reject(c)}}}();g="undefined"!==typeof exports&&null!==exports?exports:window;g.Deferred=d;
g.defer=function(){return new d}}).call(this);
